{
  "meta": {
    "project": "EduLens Desktop Application",
    "date": "2025-11-14",
    "prepared_by": "Generated by EduLens AI Assistant"
  },
  "product_overview": "EduLens is a comprehensive desktop application designed to facilitate AI-enhanced learning from YouTube videos. It provides automated transcription, AI-driven question answering, summaries, quizzes, flashcards, notes, and mindmaps, enabling users to interactively engage with video content without requiring an internet connection. The application integrates a stable video transcription pipeline using Faster-Whisper and supports local large language model (LM Studio) and cloud AI provider (Groq) for rich educational experiences within a native desktop environment built on Electron, React, and Node.js.",
  "core_goals": [
    "Provide a seamless desktop-only solution for video-based learning without browser dependencies.",
    "Ensure robust and stable transcription of YouTube videos using Faster-Whisper with fallback to whisper.cpp.",
    "Deliver AI-powered interactive study tools including Q&A, summaries, quizzes, flashcards, notes, and mindmaps based on processed video transcripts.",
    "Maintain strict port management and startup sequence to avoid conflicts and ensure reliable backend, frontend, and Electron integration.",
    "Offer both offline AI capabilities (via LM Studio local LLM) and cloud AI services (Groq API) with automatic provider fallback handling.",
    "Ensure all data is persistently stored in local file-based JSON format for transcripts, embeddings, and sessions.",
    "Support multi-language AI responses and precise time-based querying of video content."
  ],
  "key_features": [
    "Video Transcription Pipeline: Automates downloading, audio extraction, chunking, transcription via Faster-Whisper, segment merging, and persistence of transcripts as JSON files.",
    "AI Question Answering and Educational Tools: Enables users to ask questions and receive comprehensive, timestamped, transcript-based answers using local or cloud AI models.",
    "Interactive Content Generation: Structured AI-generated summaries, quizzes (multiple choice with explanations), flashcards, notes (with rich formatting), and mindmaps integrated into the learning interface.",
    "Robust Desktop Launcher: A fixed and verified launch script that aggressively cleans ports/processes, enforces strict port usage (backend on 5000, frontend on 5173), and sequences startup tasks to avoid conflicts and hanging.",
    "Stable AI Provider Integration: LM Studio connected directly using HTTP API with timeout handling, model detection, and smart fallback to Groq ensuring consistent AI feature availability and quality.",
    "Port Conflict Prevention System: Backend and frontend strictly fail if configured ports are busy, complemented by port cleanup utilities and clear user error messages guiding resolution.",
    "Native Desktop Experience: Electron wrapper providing offline capabilities, system integration (notifications, file access), and eliminating browser dependencies for ultimate user convenience."
  ],
  "user_flow_summary": [
    "User pastes a YouTube URL or video ID into the desktop app and triggers video processing.",
    "Backend downloads the video audio, splits it into chunks, transcribes each chunk using Faster-Whisper, merges transcript segments, and saves the transcript JSON to local storage.",
    "Frontend polls the backend for job status, displaying progress until transcription completes successfully.",
    "Once transcript is ready, user views the transcript alongside the video with synchronized scrolling.",
    "User interacts with AI-powered features: submits questions related to the video content, requests summaries with customizable length and style, quizzes with multiple-choice questions, flashcards, detailed notes, or mindmaps.",
    "The backend uses LM Studio local model when available or Groq cloud API otherwise, leveraging full transcript data for accurate, time-aware, and in-depth AI responses.",
    "The native Electron app provides an offline-capable, browser-free UI with seamless integration and smooth performance.",
    "User can restart or relaunch the app using the fixed launcher script to ensure all services run correctly on expected ports, with aggressive cleanup of conflicting processes."
  ],
  "validation_criteria": [
    "Backend must always start and bind to port 5000 or fail with a clear error if port is occupied.",
    "Frontend development server (Vite) must run strictly on port 5173, failing fast if port is busy.",
    "The desktop launcher script successfully kills all node and electron processes and frees required ports before startup.",
    "Video transcription pipeline completes without hanging, with Faster-Whisper processing as priority and whisper.cpp as fallback only, demonstrated by full transcript JSON stored for processed videos.",
    "AI features respond with detailed, time-aware answers, summaries, quizzes, flashcards, notes, and mindmaps correctly using transcript data with fallback handling between LM Studio and Groq.",
    "No silent failures during startup or runtime; all errors produce descriptive messages and the debug panel shows healthy status for backend, frontend, and AI providers.",
    "System successfully handles and recovers from common failure modes including port conflicts, transcription tool failures, and AI connection issues.",
    "All core API routes (`/api/video/*`, `/api/ai/*`, `/api/complete-ai/*`) respond with expected data and HTTP 200 statuses after initial backend restart and configuration fixes.",
    "User experience confirms no browser required; native desktop UI launches automatically after startup delay and remains stable during usage."
  ],
  "code_summary": {
    "tech_stack": [
      "JavaScript",
      "Node.js",
      "Express",
      "React",
      "Vite",
      "Electron",
      "File-based JSON storage (no DB)",
      "Faster-Whisper",
      "Whisper.cpp",
      "LM Studio (local LLM)",
      "Groq API (cloud LLM)"
    ],
    "features": [
      {
        "name": "Video Transcription Pipeline",
        "description": "Downloads YouTube videos, extracts audio, chunks it, runs Faster-Whisper/Whisper.cpp, merges segments, and stores transcripts as JSON on disk.",
        "files": [
          "backend/routes/videoRoutes.cjs",
          "backend/ai/pipeline/transcriptor.cjs",
          "backend/services/ultraFastTranscriptor.cjs",
          "backend/services/parallelWhisper.cjs",
          "backend/services/whisper.cjs",
          "backend/services/audioChunker.cjs"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "EduLens Video API",
            "version": "1.0.0"
          },
          "paths": {
            "/api/video/info": {
              "get": {
                "summary": "Get basic info for a YouTube video",
                "parameters": [
                  {
                    "name": "url",
                    "in": "query",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Video metadata"
                  }
                }
              }
            },
            "/api/video/process": {
              "post": {
                "summary": "Start or reuse a transcription job for a given videoId",
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "videoId": {
                            "type": "string"
                          },
                          "force": {
                            "type": "boolean"
                          }
                        },
                        "required": [
                          "videoId"
                        ]
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Job started or reused"
                  }
                }
              }
            },
            "/api/video/status": {
              "get": {
                "summary": "Get processing status for a video",
                "parameters": [
                  {
                    "name": "videoId",
                    "in": "query",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Job status including progress and stage"
                  },
                  "404": {
                    "description": "No job found"
                  }
                }
              }
            },
            "/api/video/transcript/{videoId}": {
              "get": {
                "summary": "Fetch final transcript JSON for a video",
                "parameters": [
                  {
                    "name": "videoId",
                    "in": "path",
                    "required": true,
                    "schema": {
                      "type": "string"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Transcript JSON"
                  },
                  "404": {
                    "description": "Transcript not found"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "AI Question Answering & Summaries",
        "description": "Uses full transcripts and providerManager to answer questions, generate summaries, quizzes, flashcards, notes, and mindmaps via LM Studio or Groq.",
        "files": [
          "backend/routes/aiRoutes.cjs",
          "backend/routes/completeAIRoutes.cjs",
          "backend/ai/providers/providerManager.cjs",
          "backend/ai/pipeline/embeddings.cjs",
          "backend/ai/pipeline/retriever.cjs"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "EduLens AI API",
            "version": "1.0.0"
          },
          "paths": {
            "/api/ai/status": {
              "get": {
                "summary": "Check availability of LM Studio and Groq providers",
                "responses": {
                  "200": {
                    "description": "Provider health and models"
                  }
                }
              }
            },
            "/api/ai/query": {
              "post": {
                "summary": "Ask questions about a specific video using its transcript",
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "videoId": {
                            "type": "string"
                          },
                          "question": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "videoId",
                          "question"
                        ]
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "AI answer with optional citations"
                  }
                }
              }
            },
            "/api/complete-ai/summary": {
              "post": {
                "summary": "Generate structured video summaries via CompleteAIAssistant",
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "videoId": {
                            "type": "string"
                          },
                          "length": {
                            "type": "string"
                          },
                          "style": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "videoId"
                        ]
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Summary payload"
                  }
                }
              }
            }
          }
        }
      }
    ]
  }
}
